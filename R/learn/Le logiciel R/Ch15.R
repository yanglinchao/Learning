library(multcomp)
attach(cholesterol)
str(cholesterol)
summary(trt)
aggregate(response, by = list(trt), FUN = mean)
plot(response ~ trt)
aov1 <- aov(response ~ trt)
summary(aov1)
summary(lm(response ~ trt))
summary(lm(response ~ C(trt, base = 2)))
bartlett.test(response ~ trt)
require(car)
levene.test(response, trt)
detach(cholesterol)
pairwise.t.test(response, trt, p.adjust = "bonf")
TukeyHSD(aov(response ~ trt))
par(mar = c(5, 7, 4, 2), las = 1)   #增大图形左边宽度，并以水平方式书写标签
plot(TukeyHSD(aov(response ~ trt)))
newTG <- ToothGrowth[, -3]
newTG$dose <- as.factor(ToothGrowth$dose)
attach(newTG)
str(newTG)
table(supp, dose)
interaction.plot(dose, supp, len)
interaction.plot(supp, dose, len)
require(gplots)
plotmeans(len ~ interaction(supp, dose, sep = " "), connect = list(c(1, 3, 5), c(2, 4, 6)), col = c("red", "darkgreen"), main = "Interaction Plot with 95% CIs", xlab = "Treatment and Dose Combination")
aov2 <- aov(len ~ supp*dose)
summary(aov2)
summary(lm(len ~ supp*dose))
dose.suppOJ <- summary(aov(len ~ dose, subset = supp=="OJ"))
dose.suppOJ
rat <- data.frame(lever = c(8, 6, 2, 6, 5, 1, 7, 5, 0, 9, 3, 3, 5, 4, 1), subject = gl(5, 3, 15), cond = gl(3, 1, 15))
summary(aov(lever ~ cond + Error(subject/cond), data = rat))
lecithin <- data.frame(memory = c(10, 11, 9, 3, 6, 3, 18, 20, 17, 16, 20, 14, 6, 8, 8, 5, 6, 3, 4, 9, 9, 10, 10, 6), subject = gl(4, 6, 24), test = gl(2, 3, 24), mouth = gl(3, 1, 24))
summary(aov(memory ~ mouth*test + Error(subject/(test*mouth)), data = lecithin))
bar.estim <- data.frame(bar = c(10, 11, 9, 3, 6, 3, 18, 20, 17, 16, 20, 14, 6, 8, 8, 5, 6, 3, 4, 9, 9, 10, 10, 6),
                        subject = gl(4, 6, 24), 
                        group = gl(2, 3, 24),   #因素A
                        long = gl(3, 1, 24)   #因素B
)
summary(aov(bar ~ group*long + Error(subject %in% group), data = bar.estim))
##worksheetA
noise <- gl(4, 6, 24)
grade <- c(62, 60, 63, 59, 63, 59, 56, 62, 60, 61, 63, 64, 63, 67, 71, 64, 65, 66, 68, 66, 71, 67, 68, 68)
summary(aov(grade ~ noise))
summary(lm(grade ~ noise))
pairwise.t.test(grade, noise, p.adjust.method = "bonf")
TukeyHSD(aov(grade ~ noise))
save.par <- par(no.readonly = T)
plot(TukeyHSD(aov(grade ~ noise)))
require(multcomp)
par(mar = c(5, 4, 6, 2))
tuk <- glht(lm(grade ~ noise), linfct = mcp(noise="Tukey"))
plot(cld(tuk, level = 0.05), col = "lightgrey")
imt <- read.csv("Intima_Media_Thickness.csv")
str(imt)
attach(imt)
alcohol <- as.factor(alcohol)
plot(measure ~ alcohol)
summary(aov(measure ~ alcohol))
require(car)
qqPlot(aov(measure ~ alcohol))
levene.test(aov(measure ~ alcohol))
detach(imt)
attach(sports)
str(sports)
plot(score ~ time)
table(time)
grade <- as.factor(c(gl(3, 30, 90), rep(3, 15)))
table(grade)
sports$grade <- grade
plot(score ~ grade)
summary(aov(score ~ grade))
summary(lm(score~ grade))
##worksheet B
type <- as.factor(rep(1:3, each = 2, times = 6))
temp <- as.factor(rep(c(15, 70, 125), each = 12))
time <- c(130, 74, 150, 159, 138, 168, 155, 180, 188, 126, 110, 160, 34, 80, 136, 106, 174, 150, 40, 75, 122, 115, 120, 139, 20, 82, 25, 58, 96, 82, 70, 58, 70, 45, 104, 60)
battary <- data.frame(type, temp, time)
interaction.plot(type, temp, time)
interaction.plot(temp, type, time)
require(HH)
interaction2wt(time ~ temp*type)
summary(aov(time ~ temp*type))
summary(lm(time ~ temp*type))
yield <- c(8,11,11,10,7,12,13,14,11,10,10,12,12,13,14,17,
           13,17,14,13,8,9,8,10,9,10,7,10,12,11,11,9,
           11,11,12,13,12,11,15,14)
food <- as.factor(rep(rep(1:4,each=5,2)))
levels(food) <- c("Straw","Hay","Grass","Silage")
dose <- as.factor(rep(1:2,each=20))
levels(dose) <- c("Low", "High")
milk <- data.frame(yield=yield,food=food,dose=dose)
interaction2wt(yield ~ food*dose)
summary(aov(yield ~ food*dose))
summary(lm(yield ~ food + dose))
