?rep
range <- c(582, 562, 653, 491, 541, 516, 601, 709, 392, 758, 582, 487)
A <- c(1, 1, 1, 2, 2, 2, 3, 3, 3)
B <- c(1, 2, 3, 1, 2, 3, 1, 2, 3)
plot(range ~ A, pch=B)
legend(1.5, 750, legend=1:3, pch=B)  #在（1.5,750）处添加图例
par(mfrow=c(1,2))
boxplot(range ~ A, xlab="A"); boxplot(range ~ B, xlab="B")
par(mfrow=(1,1))
range <- c(582, 562, 653, 491, 541, 516, 601, 709, 392, 758, 582, 487)
A <- c(1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4)
B <- c(1, 2, 3, 1, 2, 3, 1, 2, 3)
plot(range ~ A, pch=B)
legend(1.5, 750, legend=1:3, pch=B)  #在（1.5,750）处添加图例
par(mfrow=c(1,2))
boxplot(range ~ A, xlab="A"); boxplot(range ~ B, xlab="B")
par(mfrow=(1,1))
range <- c(582, 562, 653, 491, 541, 516, 601, 709, 392, 758, 582, 487)
A <- c(1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4)
B <- c(1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3)
plot(range ~ A, pch=B)
legend(1.5, 750, legend=1:3, pch=B)  #在（1.5,750）处添加图例
par(mfrow=c(1,2))
boxplot(range ~ A, xlab="A"); boxplot(range ~ B, xlab="B")
par(mfrow=(1,1))
A <- factor(A); B <- factor(B)   #将A、B转化为因子
(range.aov <- aov(range ~ A + B))    #拟合方差分析模型
summary(range.aov)
setwd("F:/Weiyun/R-work/R数据分析：方案与案例解析/Ch9")
beef <- c(365, 350, 343, 340, 345, 368, 363, 330, 358, 323, 353, 343)
A <- c(1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4)
B <- c(1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3)
A <- factor(A); B <- factor(B)
beef.aov <- aov(beef ~ A+B)
summary(beef.aov)
x <- scan(file = "9.3.1.txt")
group <- c(rep(1, 11), rep(2, 9), rep(3,11))
oneway.test(x ~ group, var.equal = T)
x <- scan(file = "9.3.1.txt")
group <- c(rep(1, 11), rep(2, 9), rep(3,11))
oneway.test(x ~ group, var.equal = T)
weight <- c(30, 31, 32, 31, 36, 32, 27, 29, 28)
A <- c(1, 1, 1, 2, 2, 2, 3, 3, 3)
B <- c(1, 2, 3, 1, 2, 3, 1, 2, 3)
A <- factor(A); B <- factor(B)
weight.aov <- aov(weight ~ A + B)
summary(weight.aov)
x <- c(30, 35, 31, 32, 32, 30, 31, 32, 36, 35, 32, 30, 27, 25, 29, 27, 28, 25)
A <- c(rep(1,6), rep(2, 6), rep(3,6))
B <- c(1,1,2,2,3,3,1,1,2,2,3,3,1,1,2,2,3,3)
A <- factor(A); B <- factor(B)
x.aov <- aov(x ~ A + B + A*B)
summary(x.aov)
